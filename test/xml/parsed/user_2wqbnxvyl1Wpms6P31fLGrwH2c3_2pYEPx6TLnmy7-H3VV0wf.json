{
  "GhVersion": "0.2.2",
  "componentsCount": 1,
  "uniqueCount": 1,
  "ghLibs": [],
  "ghs": [
    {
      "GraftStandardOutputLines": true,
      "InstanceGuid": "4e00b7fd-0df1-4e0c-b77a-26dc7342bc96",
      "MarshGuids": false,
      "MarshInputs": false,
      "MarshOutputs": false,
      "Name": "C# Script",
      "NickName": "dangerouslyFlattenLayers",
      "ScriptComponentVersion": 3,
      "UsingLibraryInputParam": false,
      "UsingScriptInputParam": false,
      "UsingScriptOutputParam": false,
      "UsingStandardOutputParam": true,
      "identifier": {
        "guid": "b6ba1144-02d6-4a2d-b53c-ec62e290eeb7",
        "name": "C# Script"
      },
      "pivot": {
        "x": 318,
        "y": 74
      },
      "bounds": {
        "x": 304,
        "y": -16,
        "width": 57,
        "height": 179
      },
      "in": {
        "inputParams": [],
        "inputParamsZui": [],
        "inputBounds": [],
        "inputPivots": []
      },
      "out": {
        "outputParams": [
          {
            "Description": "The execution information, as output and error streams",
            "InstanceGuid": "6751fa3c-62ca-4668-8bd8-303f4876bb82",
            "Name": "out",
            "NickName": "out",
            "Optional": false,
            "SourceCount": 0
          },
          {
            "AllowTreeAccess": false,
            "Description": "No conversion",
            "InstanceGuid": "71698d5a-49fb-4995-bbc4-8fa9e908b17d",
            "Name": "a",
            "NickName": "a",
            "Optional": false,
            "ScriptParamAccess": 0,
            "ScriptParameterVersion": 2,
            "ShowTypeHints": true,
            "SourceCount": 0,
            "TypeHintID": "6a184b65-baa3-42d1-a548-3915b401de53"
          }
        ],
        "outputParamsZui": [
          {
            "guid": "3ede854e-c753-40eb-84cb-b48008f14fd4",
            "typeCode": 9
          },
          {
            "guid": "08908df5-fa14-4982-9ab2-1aa0927566aa",
            "typeCode": 9
          }
        ],
        "outputBounds": [
          {
            "x": 333,
            "y": -14,
            "width": 26,
            "height": 87
          },
          {
            "x": 333,
            "y": 73,
            "width": 26,
            "height": 88
          }
        ],
        "outputPivots": [
          {
            "x": 346,
            "y": 29.75
          },
          {
            "x": 346,
            "y": 117.25
          }
        ]
      }
    }
  ],
  "scripts": [
    {
      "taxon": "*.*.csharp",
      "MarshGuids": false,
      "MarshInputs": false,
      "MarshOutputs": false,
      "Title": "dangerouslyFlattenLayers",
      "script": "// Grasshopper Script Instance\n#region Usings\nusing System;\nusing System.Linq;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Drawing;\n\nusing Rhino;\nusing Rhino.Geometry;\n\nusing Grasshopper;\nusing Grasshopper.Kernel;\nusing Grasshopper.Kernel.Data;\nusing Grasshopper.Kernel.Types;\nusing Layer = Rhino.DocObjects.Layer;\n#endregion\n\npublic class Script_Instance : GH_ScriptInstance\n{\n    #region Notes\n    /* \n      Members:\n        RhinoDoc RhinoDocument\n        GH_Document GrasshopperDocument\n        IGH_Component Component\n        int Iteration\n\n      Methods (Virtual & overridable):\n        Print(string text)\n        Print(string format, params object[] args)\n        Reflect(object obj)\n        Reflect(object obj, string method_name)\n    */\n    #endregion\n\n    private void RunScript(ref object a)\n    {\n   // Get the active document\n    RhinoDoc doc = RhinoDoc.ActiveDoc;\n\n    // Get all layers\n    var layers = doc.Layers;\n\n    // Iterate over all layers\n    for (int i = layers.Count - 1; i >= 0; i--)\n    {\n      Layer layer = layers[i];\n\n      // If the layer has a parent, move it to the top level\n      if (layer.ParentLayerId != Guid.Empty)\n      {\n        layer.ParentLayerId = Guid.Empty;\n      }\n\n      // Check for duplicate layer names and merge objects\n      foreach (Layer otherLayer in layers)\n      {\n        if (otherLayer != layer && otherLayer.Name == layer.Name)\n        {\n          // Move objects from the duplicate layer to the current layer\n          foreach (Rhino.DocObjects.RhinoObject obj in doc.Objects.FindByLayer(otherLayer))\n          {\n            obj.Attributes.LayerIndex = layer.Index;\n            obj.CommitChanges();\n          }\n\n          // Delete the duplicate layer\n          layers.Delete(otherLayer.Index, true);\n          break;\n        }\n      }\n    }\n  }  \n   }\n\n"
    }
  ]
}